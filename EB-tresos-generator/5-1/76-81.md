这是为您翻译的文档 **第 76-81 页** 的内容。

这一部分主要完成了 **Schema 节点** 的介绍，详细说明了 **Data 节点** 的各类标签（`d:ctr`, `d:var` 等），并深入讲解了 **工厂 (Factories)** 和 **路径寻址 (Path addressing)** 机制，最后开启了关于 **AUTOSAR 映射** 的新章节。

---

### 5.1.6. Schema 节点 (续)

#### 5.1.6.4. var (变量 - 续)

**5.1.6.4.2. 有效子节点**

* 无

#### 5.1.6.5. ref (引用 - `v:ref`)

引用节点定义了一个指向另一个节点的引用。它对应于 AUTOSAR 的引用参数。

**5.1.6.5.1. 属性和数据属性**

| 属性名 | 类型 | 描述 |
| --- | --- | --- |
| **type** | string | 引用的类型。可以是以下之一：<br>

<br>- `REFERENCE`<br>

<br>- `CHOICE-REFERENCE`<br>

<br>- `SYMBOLIC-NAME-REFERENCE`<br>

<br>- `FOREIGN-REFERENCE`<br>

<br>- `INSTANCE-REFERENCE`<br>

<br>- `URI-REFERENCE` |
| **WITH-AUTO** | boolean | 如果设置为 true，用户可以选择手动输入值，或者让代码生成器在生成期间计算它。如果为 false，用户必须手动编辑。 |

| 数据属性 | 类型 | 描述 |
| --- | --- | --- |
| **DEFAULT** | string | 定义 Data 节点的默认值。这也可以是一个自动属性。 |
| **RANGE** | string array | 限制有效值范围（即允许引用的目标）。范围的解释取决于 Schema 节点的类型。 |
| **REF** | string | 定义引用的目标。对于 `REFERENCE` 类型，这通常是目标节点的路径。 |

**5.1.6.5.2. 有效子节点**

* 无

---

### 5.1.7. Data 节点 (Data-nodes)

Data 节点包含实际的配置数据。它们由命名空间 `http://www.tresos.de/_projects/DataModel2/06/data.xsd`（前缀通常为 `d`）定义。

Data 节点通常不直接手动编写，而是由工具根据 Schema 节点生成或由用户在 GUI 中配置后保存。Data 节点的一个关键特性是它们**总是绑定到一个 Schema 节点**。

#### 5.1.7.1. ctr (容器 - `d:ctr`)

`d:ctr` 定义一个容器 Data 节点。一个容器将其他节点分组，所有子节点都由唯一的名称标识。

**5.1.7.1.1. 属性**

* 无（除了标准的 XML 属性如 `name`, `type` 等）

**5.1.7.1.2. 有效子节点**

* `d:ctr`
* `d:chc`
* `d:lst`
* `d:var`
* `d:ref`

#### 5.1.7.2. chc (选择 - `d:chc`)

`d:chc` 定义一个选择 Data 节点。一个选择 Data 节点**包含且仅包含一个容器节点**。
这个容器 Data 节点必须符合该选择 Data 节点所绑定的选择 Schema 节点（Choice Schema Node）中的某一个容器 Schema 节点。

**5.1.7.2.1. 属性**

* 无

**5.1.7.2.2. 有效子节点**

* `d:ctr`

#### 5.1.7.3. lst (列表 - `d:lst`)

`d:lst` 创建一个列表 Data 节点。列表中的子节点必须属于同一类型（容器、选择、变量或引用）。列表 Data 节点的子节点必须符合绑定的 Schema 节点的子节点定义。

列表有两种变体：**列表 (Lists)** 和 **映射 (Maps)**，这通过列表 Schema 节点的 `TYPE` 属性来选择：

* **空类型**：创建一个列表节点。列表包含有序的条目序列。
* **"MAP"**：创建一个映射类型的列表。映射是一个有序列表，其中所有条目的**名称在列表内必须是唯一的**。

**5.1.7.3.1. 属性**

* 无

**5.1.7.3.2. 有效子节点**

* `d:ctr`
* `d:chc`
* `d:var`
* `d:ref`

#### 5.1.7.4. var (变量 - `d:var`)

`d:var` 创建一个变量 Data 节点。变量 Data 节点存储单个配置值。

**5.1.7.4.1. 属性**

* 无

**5.1.7.4.2. 有效子节点**

* 无

#### 5.1.7.5. ref (引用 - `d:ref`)

`d:ref` 创建一个引用 Data 节点。引用 Data 节点是一个配置参数，它引用另一个配置参数。对该节点的引用以**节点路径表达式 (node path expression)** 的形式存储在 Data 节点的 `value` 属性中。

**5.1.7.5.1. 属性**

* 无

**5.1.7.5.2. 有效子节点**

* 无

---

### 5.1.8. 工厂 (Factories)

DataModel 使用工厂来创建节点。每个工厂都了解不同的节点类型，并可能定制创建的节点（添加特定属性等）。此外，每个工厂可以为该工厂定义的节点和属性定义新的命名空间。

支持以下工厂：

* **default**：一个创建所有节点类型的默认节点实例的工厂。
* **autosar**：此工厂必须用于创建 AUTOSAR ECU 配置、ECU 参数定义和其他 AUTOSAR 格式的节点。

节点的工厂可以通过 XML 属性 `factory` 设置，该属性可应用于所有节点标签。当一个节点具有 `factory` 属性时，指定的工厂将用于创建该节点以及**所有没有指定工厂的后续子节点**（即，如果所有节点都使用相同的工厂，只需在根节点指定即可）。

如果工厂定义了具有特殊命名空间的属性或节点，则必须在指定工厂的节点处定义这些命名空间，例如：

```xml
<d:ctr type="AUTOSAR" factory="autosar"
 xmlns:ad="http://www.tresos.de/_projects/DataModel2/08/admindata.xsd"
 xmlns:icc="http://www.tresos.de/_projects/DataModel2/08/implconfigclass.xsd">

```

---

### 5.1.9. 路径寻址 (Path addressing)

引用 Data 节点、Data 节点的 `DEF` 属性以及引用 Schema 节点的 `REF` 数据属性在其字符串值中引用其他节点。这是通过以下形式的路径表达式完成的：
`path-type:path`

Data 节点的 `DEF` 属性在使用 XPath 寻址时可能如下所示：

```xml
<d:ctr name="myCtr">
 <a:a name="DEF" value="XPath:/AUTOSAR/TOP-LEVEL-PACKAGES/myPkg/ELEMENTS/myModuleDef/myCtr"/>
</d:ctr>

```

或者使用 AUTOSAR 寻址：

```xml
<d:ctr name="myCtr">
 <a:a name="DEF" value="ASPath:/myPkg/myModuleDef/myCtr"/>
</d:ctr>

```

# 支持以下寻址模式 (Addressing schemas)：

| 模式                       | 描述                                                                                              |
| ------------------------ | ----------------------------------------------------------------------------------------------- |
| **XPath**                | 通过 XPath 路径引用节点（不是完整的 XPath 表达式，而是路径）。                                                          |
| **XPathDataOfSchema**    | 引用绑定到该 XPath 表达式指向的 Schema 节点的==所有 Data 节点。==                                                   |
| **SchemaViaParentByIdx** | 获取父节点的 Schema 节点，并返回该节点的 Schema 子节点，其索引由表达式的值决定。如果表达式为空，则使用值 0。                                 |
| **SchemaViaParent**      | 获取父节点的 Schema 节点，并返回该节点的 Schema 子节点，其名称由表达式的值决定。如果表达式为空，则使用节点名称。如果父节点不是列表节点，则使用第一个 Schema 父子节点。 |
| **ASPath**               | 通过 AUTOSAR 路径表达式引用节点。此路径表达式仅适用于由 `autosar` 工厂创建的节点。                                             |
| **ASPathDataOfSchema**   | 引用绑定到该 AUTOSAR 路径表达式指向的 Schema 节点的==所有 Data 节点。==仅适用于 `autosar` 工厂创建的节点。                        |
| **ASPathParentNode**     | 引用由 AUTOSAR 路径引用的节点的父节点。仅适用于 `autosar` 工厂创建的节点。                                                 |
|                          |                                                                                                 |

---

### 5.2. 概念：AUTOSAR ECU 配置到 XDM 的映射 (Mapping AUTOSAR ECU Configuration to XDM)

AUTOSAR 定义了用于描述 ECU 配置及其参数定义的 XML 格式。EB tresos Studio 使用 XDM 格式来存储这些信息。本节描述 AUTOSAR 元素如何映射到 XDM 节点。

#### 5.2.1. 节点映射 (Node mapping)

**5.2.1.1. Schema 节点 (Schema-Nodes)**

**5.2.1.1.1. AR-PACKAGE**
AUTOSAR 的 `AR-PACKAGE` 映射到 XDM 的 `v:ctr`（容器节点）。

---

**（第 76-81 页翻译结束）**